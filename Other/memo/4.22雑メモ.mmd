アプリを使用した英会話手順
- ユーザがしゃべる
- Android:MediaRecorderで音声認識
- SpeechToTextAPIでText化
https://cloud.google.com/speech-to-text?hl=ja
- OpenAI ChatCompletionへユーザの会話内容を送信
- 上記のレスポンスにて、AIの返答をUIに表示
- TextToSpeechAPIにてAIの返答のみ音声化
https://cloud.google.com/text-to-speech?hl=ja
- 完了と同時に、会話内容をGoogle Cloud Storage（GCS）にログ

↑までのシーケンス
```
sequenceDiagram
    participant User
    participant App
    participant MediaRecorder
    participant SpeechToTextAPI
    participant OpenAIChatCompletion
    participant TextToSpeechAPI
    participant GoogleCloudStorage

    User ->> App: Speak
    App ->> MediaRecorder: Record voice
    MediaRecorder ->> App: Voice data
    App ->> SpeechToTextAPI: Convert voice data to text
    SpeechToTextAPI ->> App: User text
    App ->> OpenAIChatCompletion: Send user text
    OpenAIChatCompletion ->> App: AI response text
    App ->> TextToSpeechAPI: Convert AI response to voice
    TextToSpeechAPI ->> App: AI voice
    App ->> User: Display AI response and play AI voice
    App ->> GoogleCloudStorage: Log conversation
```

KMMによるKotlin -> Swiftの変換

```
import SwiftUI
import shared

struct ContentView: View {
    @ObservedObject private var viewModel = MyViewModel()

    var body: some View {
        VStack {
            Button(action: {
                viewModel.incrementCounter()
            }) {
                Text("count : \(viewModel.counter)")
            }
        }
    }
}

class MyViewModel: ObservableObject {
    @Published private(set) var counter: Int = 0
    private let myKmmViewModel: MyKmmViewModel

    init() {
        myKmmViewModel = MyKmmViewModel()
        myKmmViewModel.stateFlow.watch { [weak self] count in
            self?.counter = count
        }
    }

    func incrementCounter() {
        myKmmViewModel.incrementCounter()
    }
}

```

あいであおきば💡💡
- TextCompletionで文法添削？
- チャットアイコンからSystemのプロンプトを変更可能にする
- FloatingActionButtonで会話のリセット
- PixelWatchで簡易英語翻訳くらいはやりたい
- folding or tablet にて添削の部分をできるようにする？
- 言語の変更が可能、イギリス英語かアメリカ英語かなど、UIの最初に設定させてしまえばよい
- ストリーム処理をしてみる?
- サーバー側 versionCatalog導入


Material Design 3 階層
色とフォントとShapeを追ってみる

